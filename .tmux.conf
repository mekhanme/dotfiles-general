# http://man7.org/linux/man-pages/man1/tmux.1.html

# ğŸ¤– == ğŸ¤– == ğŸ¤– == ğŸ¤–  general  ğŸ¤– == ğŸ¤– == ğŸ¤– == ğŸ¤– #

# set-option -s detach-on-destroy off

bind-key C-0 command-prompt "new-session -s %1 ssh %1 \; set-option default-command \"ssh %1\""

set-option -g default-terminal "xterm-256color"
set-option -ga terminal-overrides ",xterm-256color:Tc"
# set-option -g terminal-overrides 'xterm*:smcup@:rmcup@'

set-option -g prefix2 M-e
bind-key M-e send-prefix -2
# unbind C-b
# set-option -g prefix "C-\\"

# don't suspend-client
unbind-key C-z

set-environment -g SSH_AUTH_SOCK $HOME/.ssh/ssh_auth_sock


# bind-key -T root 'C-/' send-keys ' Msemicolon'

# bind-key -n 'C-\' if-shell "$is_vim" "send-keys 'C-\\'" "select-pane -l"

# bind-key    -T prefix       T                     run-shell "/root/.tmux/plugins/tmux-sidebar/scripts/toggle.sh 'tree -C | sh -c \"LESS= less --dumb --chop-long-lines --tilde --IGNORE-CASE --RAW-CONTROL-CHARS\",left,40,focus' '#{pane_id}'"


# unbind f
# TODO: ERROR no buffer fzf2
# bind-key -n M-y run-shell 'tmux show-buffer -b fzf | tr -d "\n" | tmux load-buffer -b fzf2 - \; paste-buffer -b fzf2 \; delete-buffer -b fzf2'
# | tmux load-buffer -b fzf - | tmux paste-buffer -b fzf

### ğŸ¤– >>= ğŸ¤– >>= ğŸ¤– >>= ğŸ¤–  display  ğŸ¤– =<< ğŸ¤– =<< ğŸ¤– =<< ğŸ¤– ###

set-option -w -q -g utf8 on

set-option -g history-limit 50000

unbind-key M-m
# Ğ²ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ / Ğ¾Ñ‚ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ² Ğ¾ĞºĞ½Ğµ
bind-key M-m set-option -w monitor-activity
# \;\ display-message 'Monitor window activity [#{?monitor-activity,ON,OFF}]'

bind-key M-b set-option -w monitor-bell
# \;\ display-message 'Monitor bell window activity [#{?monitor-bell,ON,OFF}]'

unbind-key M-n
# Ğ²ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ / Ğ¾Ñ‚ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ğ½ĞµĞ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ² Ğ¾ĞºĞ½Ğµ
bind-key M-n if -F '#{monitor-silence}' \
  'set-option -w monitor-silence 0' \
  'command-prompt -p "Monitor silence: interval (s): " "set-option -w monitor-silence %%"'
# ; display-message "Monitor window silence [OFF]"
# 'set-option -w monitor-silence 0' \

# tmux set-option -w monitor-silence 10 ; tmux display -p '#{monitor-silence}' ; tmux display -p '#{window_silence_flag}' ; tmux show-options -wg | grep monitor-silence

set-option -w -g pane-base-index 1
set-option -w -g base-index 1
set-option -g renumber-windows on

# ğŸ¤– == ğŸ¤– == ğŸ¤– == ğŸ¤–  navigation  ğŸ¤– == ğŸ¤– == ğŸ¤– == ğŸ¤– #

bind-key - split-window -v -c "#{pane_current_path}"
bind-key _ split-window -h -c "#{pane_current_path}"

bind-key > swap-pane -D
bind-key < swap-pane -U

bind-key e last-pane
bind-key M-e last-window

bind-key -n M-1 select-window -t 1
bind-key -n M-2 select-window -t 2
bind-key -n M-3 select-window -t 3
bind-key -n M-4 select-window -t 4
bind-key -n M-5 select-window -t 5
bind-key -n M-6 select-window -t 6
bind-key -n M-7 select-window -t 7
bind-key -n M-8 select-window -t 8
bind-key -n M-9 select-window -t 9
bind-key -n M-0 select-window -t 10

unbind-key w
bind-key w resize-pane -Z

# reload configuration
bind-key r source-file -q ~/.tmux.conf \; display '~/.tmux.conf sourced'


unbind-key c
# Ğ½Ğ¾Ğ²Ğ¾Ğµ Ğ¾ĞºĞ½Ğ¾ Ñ Ñ‚Ğ¾Ğ¹ Ğ¶Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‡ĞµĞ¹ Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸ĞµĞ¹ (cwd)
bind-key Ğ¡ new-window -c "#{pane_current_path}"
bind-key c new-window

#  Turn the mouse on, but without copy mode dragging
set-option -g mouse off
unbind-key m
bind-key m set mouse off
bind-key M set mouse on
unbind-key -n MouseDrag1Pane
unbind-key -T copy-mode MouseDrag1Pane

#  make scrolling with wheels work
# bind -n WheelUpPane if-shell -F -t = "#{mouse_any_flag}" "send-keys -M" "if -Ft= '#{pane_in_mode}' 'send-keys -M' 'select-pane -t=; copy-mode -e; send-keys -M'"
# bind -n WheelDownPane select-pane -t= \; send-keys -M
#  A key to toggle between smallest and largest sizes if a window is visible in
#  multiple places
# bind F set -w window-size

# # [ Shift arrow ] Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ¾ĞºĞ½Ğ°Ğ¼Ğ¸
# bind -n S-Left  previous-window
# bind -n S-Right next-window

# [ Shift arrow ] Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ¿Ğ°Ğ½ĞµĞ»ÑĞ¼Ğ¸
bind-key -n S-Left select-pane -L
bind-key -n S-Right select-pane -R
bind-key -n S-Up select-pane -U
bind-key -n S-Down select-pane -D

unbind M-Up
unbind M-Down
unbind M-Left
unbind M-Right
# [ Prefix Shift arrow ] Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€Ğ° Ğ¿Ğ°Ğ½ĞµĞ»Ğ¸
bind-key S-Up resize-pane -U 5
bind-key S-Down resize-pane -D 5
bind-key S-Left resize-pane -L 5
bind-key S-Right resize-pane -R 5

# Link window
unbind-key L
bind-key L command-prompt -p "Link window from (session:window): " "link-window -s %% -a"

# Kill pane/window/session shortcuts
unbind-key X
bind-key x kill-pane
bind-key X kill-window
bind-key k kill-session

# Merge session with another one (e.g. move all windows)
# If you use adhoc 1-window sessions, and you want to preserve session upon exit
# but don't want to create a lot of small unnamed 1-window sessions around
# move all windows from current session to main named one (dev, work, etc)
unbind-key C-u
bind-key C-u command-prompt -p "Session to merge with: " \
   "run-shell 'yes | head -n #{session_windows} | xargs -I {} -n 1 tmux movew -t %%'"

# Detach from session
unbind-key D
bind-key D if -F '#{session_many_attached}' \
    'confirm-before -p "Detach other clients? (y/n)" "detach -a"' \
    'display "Session has only 1 client attached"'

# -- buffers -------------------------------------------------------------------

# [ Enter ] Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒÑÑ Ğ² copy mode
bind-key Enter copy-mode

# [ Space :: copy-mode ] Ğ²Ñ‹Ğ´ĞµĞ»Ğ¸Ñ‚ÑŒ ÑÑ‚Ñ€Ğ¾ĞºÑƒ
bind-key -T copy-mode Space send-keys -X begin-selection \; send-keys C-a

# [ Enter :: copy-mode ] ÑĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ²Ñ‹Ğ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ² Ğ±ÑƒÑ„ĞµÑ€ Ğ¸ Ğ²Ñ‹Ğ¹Ñ‚Ğ¸ Ğ¸Ğ· Ñ€ĞµĞ¶Ğ¸Ğ¼Ğ° copy mode
bind-key -T copy-mode Enter send-keys -X copy-selection-and-cancel

# [ Alt - W :: copy-mode ] ÑĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ²Ñ‹Ğ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ² Ğ±ÑƒÑ„ĞµÑ€ X
bind-key -T copy-mode M-w send-keys -X copy-selection-and-cancel \; run-shell "tmux save-buffer - | xclip >/dev/null"

# [ Alt - PgUp ] ÑĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ ÑÑ‚Ñ€Ğ¾ĞºÑƒ Ğ² Ñ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ğ»Ğµ
# Ğ½Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚
# bind-key -n M-PPage send-keys C-a \; copy-mode \; send-keys -X copy-end-of-line

# TODO: ÑĞ¾Ñ‡ĞµÑ‚Ğ°Ğ½Ğ¸Ğµ Ğ½Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚,Ğ¿Ğ¾Ñ‡Ğ¸Ğ½Ğ¸Ñ‚ÑŒ
# bind-key -T copy-mode M-NPage send-keys -X next-paragraph
# bind-key -T copy-mode M-PPage send-keys -X previous-paragraph

bind-key b list-buffers  # list paste buffers
bind-key p paste-buffer  # paste from the top paste buffer
bind-key P choose-buffer # choose which buffer to paste from

# # Status line colours
# set-option -g status-left ""
# set-option -g status-style "bg=colour249"
# set -ag status-style "fg=black"
# set-option -g window-status-current-style "bg=green"
# set -ag window-status-current-style "fg=black"

# # Status items right side
# set-option -g status-interval 15
# set-option -g status-right '#[fg=yellow]#(cut -d " " -f 1 /proc/loadavg)#[default] #[fg=black]%H:%M#[default]'




### ğŸ¤– >>= ğŸ¤– >>= ğŸ¤–  appearence and status bar  ğŸ¤– =<< ğŸ¤– =<< ğŸ¤– ###

set-option -g status on
set-option -g status-interval 5
set-option -g status-position bottom
set-option -g status-justify centre
set-option -g status-left-length 100
set-option -g status-right-length 150

# #6a1b9a  #9c27b0  #80cbc4  #64b5f6

# Ñ†Ğ²ĞµÑ‚ Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ Ğ¿Ğ°Ğ½ĞµĞ»Ğ¸ (Ğ¿Ğ¾ÑĞµÑ€ĞµĞ´Ğ¸Ğ½Ğµ)
set-option -g status-style "bg=#6c6cd2,fg=#9c27b0"

# Ñ†Ğ²ĞµÑ‚ Ğ¸ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ğ»ĞµĞ²Ğ¾Ğ¹ Ñ‡Ğ°ÑÑ‚Ğ¸ Ğ¿Ğ°Ğ½ĞµĞ»Ğ¸
set-option -g status-left "\
#[fg=#80cbc4,bg=#6a1b9a,bold] \
$#S #[fg=#6a1b9a,bg=#9c27b0,nobold]î‚°#[fg=#80cbc4,bg=#9c27b0] \
@#Iâ•³%%#P #[fg=#9c27b0,bg=#80cbc4]î‚° #[fg=#6a1b9a,bg=#80cbc4] \
#{?window_zoomed_flag,ğŸ”,}#{?monitor-activity,ğŸ‘€,}#{?monitor-bell,ğŸ‘¾,}#{?#{!=:#{monitor-silence},0},ğŸ˜º#{monitor-silence}s,} #{?client_prefix,ğŸ’œ, } \
#[fg=#80cbc4,bg=#6c6cd2,nobold]î‚°"
# #{prefix_highlight}"

# Ñ†Ğ²ĞµÑ‚ Ğ¸ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ğ¿Ñ€Ğ°Ğ²Ğ¾Ğ¹ Ñ‡Ğ°ÑÑ‚Ğ¸ Ğ¿Ğ°Ğ½ĞµĞ»Ğ¸
# set-option -g status-right "\
# #[fg=#80cbc4,bg=#6c6cd2]î‚²#[fg=#6c6cd2,bg=#80cbc4] \
# #[fg=#6c6cd2,bg=#80cbc4]\
# #{docker_status}\
# ğŸ¤–â•³#[fg=#9c27b0]#(echo ${SSH_AGENT_ID} | sed 's/.*@//') #[fg=#6c6cd2]\
# #[fg=#9c27b0,bg=#80cbc4]î‚²#[fg=#80cbc4,bg=#9c27b0] \
# #{?#{>=:#{client_width},70},"...",#(date +"%H:%M")}<~#{?#{>=:#{client_width},70},"",#(date -I)} \
# #[fg=#6a1b9a,bg=#9c27b0]î‚²#[fg=#80cbc4,bg=#6a1b9a,bold] \
# #(wemux status_users) #H "


set-option -g status-right " \
#[fg=#80cbc4,bg=#6c6cd2]î‚²#[fg=#6c6cd2,bg=#80cbc4] \
#[fg=#6c6cd2,bg=#80cbc4] \
#{docker_status} \
#[fg=#9c27b0] \
#([ "${SSH_AGENT_ID}" = "/root/.ssh/id_rsa" ] && echo ğŸ¤–|| echo ğŸ¤–â•³$(echo ${SSH_AGENT_ID} | sed 's/.*@//')) \
#[fg=#6c6cd2] \
#[fg=#9c27b0,bg=#80cbc4]î‚²#[fg=#80cbc4,bg=#9c27b0] \
#{?#{>=:#{client_width},70},"...",#(date +"%H:%M")}<~#{?#{>=:#{client_width},70},"",#(date -I)} \
#[fg=#6a1b9a,bg=#9c27b0]î‚²#[fg=#80cbc4,bg=#6a1b9a,bold] \
#(wemux status_users) #(/bin/bash $HOME/.tmux/kube-tmux/kube.tmux 250 red cyan) #H "

# #{sysstat_cpu}<>#{sysstat_mem}
# ğŸ¤–:[#(echo $SSH_AGENT_ID) \
# ğŸ³â•³#[fg=#9c27b0]#(docker system info > /dev/null 2>&1 && docker system info --format '{{json .Name}}' | xargs || echo "error")
# ğŸ”³
# #{package_updates} #{simple_git_status} #{ipinfo} #{uptime}
# #{free_mem} #{download_speed} #{upload_speed} #{net_speed} #{sysstat_cpu} #{sysstat_mem} #{sysstat_swap} #{sysstat_loadavg}
#

# https://github.com/jimeh/tmux-themepack
# https://github.com/powerline/powerline
# https://www.nordtheme.com/ports/tmux

# https://github.com/arl/tmux-gitbar
# git status --porcelain
# source-file "$HOME/.tmux-gitbar/tmux-gitbar.tmux"

### ğŸ¤– >>= ğŸ¤– >>= ğŸ¤–  window / pane options  ğŸ¤– =<< ğŸ¤– =<< ğŸ¤– ###

# Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ¿ĞµÑ€ĞµĞ¸Ğ¼ĞµĞ½Ğ¾Ğ²Ñ‹Ğ²Ğ°Ñ‚ÑŒ Ğ¾ĞºĞ½Ğ¾
set-option -w -g automatic-rename on
set-option -w -g automatic-rename-format "#{pane_current_command}"

#  Rather than constraining window size to the maximum size of any client
#  connected to the *session*, constrain window size to the maximum size of any
#  client connected to *that window*. Much more reasonable.
set-option -w -g aggressive-resize on

# Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾Ğ³Ğ¾ Ğ¸ Ğ½ĞµĞ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾Ğ³Ğ¾ Ğ¾ĞºĞ½Ğ° Ğ² Ğ¿Ğ°Ğ½ĞµĞ»Ğ¸ ÑÑ‚Ğ°Ñ‚ÑƒÑĞ°
set-option -w -g window-status-current-format "    #[fg=#6c6cd2,bg=#64b5f6,nobold]î‚°#[fg=#9c27b0,nobold] ğŸ”¶#I#{?pane_in_mode,ğŸ“,}#{?window_zoomed_flag,ğŸ”,}#{?window_bell_flag,ğŸ‘¾,}#{?pane_dead,ğŸ™ˆ,}::#W    #[fg=#6c6cd2,bg=#64b5f6]î‚²"
set-option -w -g window-status-format "    #[fg=#80cbc4] #{?window_last_flag,ğŸ”¸,}#I#{?pane_in_mode,ğŸ“,}#{?window_zoomed_flag,ğŸ”,}#{?window_activity_flag,ğŸ‘€,}#{?window_bell_flag,ğŸ‘¾,}#{?window_silence_flag,ğŸ˜º,}#{?pane_dead,ğŸ™ˆ,}::#W    "
# #{?window_activity_flag,ğŸ‘â€ğŸ—¨,}

# Ñ†Ğ²ĞµÑ‚ bg Ğ¿Ñ€ĞµĞ´Ñ‹Ğ´ÑƒÑ‰ĞµĞ³Ğ¾ Ğ¾ĞºĞ½Ğ° Ğ² Ğ¿Ğ°Ğ½ĞµĞ»Ğ¸ ÑÑ‚Ğ°Ñ‚ÑƒÑĞ°
set-option -w -g window-status-last-style "bg=default"

# Ñ€Ğ°Ğ·Ğ´ĞµĞ»Ğ¸Ñ‚ĞµĞ»ÑŒ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ¾ĞºĞ½Ğ°Ğ¼Ğ¸ Ğ² Ğ¿Ğ°Ğ½ĞµĞ»Ğ¸ ÑÑ‚Ğ°Ñ‚ÑƒÑĞ°
set-option -w -g window-status-separator ""

# Ñ†Ğ²ĞµÑ‚ bg Ğ¸ fg Ğ¾ĞºĞ½Ğ° Ğ¿Ñ€Ğ¸ Ğ²Ğ¾Ğ·Ğ½Ğ¸ĞºĞ½Ğ¾Ğ²ĞµĞ½Ğ¸Ğ¸ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸
set-option -w -g window-status-activity-style "bg=#6c6cd2,fg=#64b5f6"
set-option -w -g window-status-bell-style "bg=#6c6cd2,fg=#80cbc4"

# Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶Ğ°Ñ‚ÑŒ Ğ´Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½ÑƒÑ ÑÑ‚Ğ°Ñ‚ÑƒÑĞ½ÑƒÑ Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ
set-option -w -g pane-border-status bottom
set-option -w -g pane-border-format " #[fg=#80cbc4]::#[fg=default] #[fg=#64b5f6]#P#[fg=default] #{?pane_active,ğŸ”¸,}#{?window_zoomed_flag,ğŸ”,}#{?pane_in_mode,ğŸ“,}#{?selection_present,ğŸ”µ,} #{pane_current_path}  #{pane_start_command}#[fg=#80cbc4]::#[fg=default] #[fg=#64b5f6]#{pane_current_command} #[fg=#80cbc4]::#[fg=default] #(gitmux -q -fmt tmux #{pane_current_path}) #[fg=#80cbc4]::#[fg=default] "
set-option -w -g pane-border-style "bg=default,fg=#80cbc4"
set-option -w -g pane-active-border-style "bg=default,fg=#6c6cd2"

# Ñ†Ğ²ĞµÑ‚ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹
set-option -g message-style "bg=#9c27b0,fg=#80cbc4"
set-option -g message-command-style "bg=#9c27b0,fg=#80cbc4"

# Ñ†Ğ²ĞµÑ‚ Ğ¸Ğ½Ğ´Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€Ğ° copy-mode Ğ² Ğ¿Ñ€Ğ°Ğ²Ğ¾Ğ¼ Ğ²ĞµÑ€Ñ…Ğ½ĞµĞ¼ ÑƒĞ³Ğ»Ñƒ
set-option -g mode-style "bg=#9c27b0,fg=#80cbc4"


set-option -g set-titles on
# TODO:ÑĞ´ĞµĞ»Ğ°Ñ‚ÑŒ Ñ…Ğ¾ÑÑ‚Ğ½ĞµĞ¹Ğ¼ Ğ¸ Ñ€Ğ°Ğ·Ğ½Ñ‹Ğµ Ğ·Ğ½Ğ°Ñ‡ĞºĞ¸ Ğ´Ğ»Ñ Ñ€Ğ°Ğ·Ğ½Ñ‹Ñ… Ñ…Ğ¾ÑÑ‚Ğ¾Ğ²
set-option -g set-titles-string '#H ğŸ‘¾ #S'

#  activity
# TODO:Ñ€Ğ°Ğ·Ğ¾Ğ±Ñ€Ğ°Ñ‚ÑŒÑÑ Ñ ÑÑ‚Ğ¸Ğ¼

# ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ Ğ² Ğ¾ĞºĞ½Ğµ
set-option -w -g monitor-activity on
set-option -w -g monitor-bell off
set-option -w -g bell-action other


# Ğ¿Ğ¾Ğ·Ğ²Ğ¾Ğ»Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ°Ğ¼ Ğ² Ğ¿Ğ°Ğ½ĞµĞ»Ğ¸ ÑƒÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°Ñ‚ÑŒ window name
set-option -g allow-rename on

# Ñ†Ğ²ĞµÑ‚ bg Ğ¸ fg Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾Ğ¹ Ğ¿Ğ°Ğ½ĞµĞ»Ğ¸
set-option -g window-active-style "fg=default,bg=default"

# Ğ·Ğ°ĞºÑ€Ñ‹Ğ²Ğ°Ñ‚ÑŒ / Ğ½Ğµ Ğ·Ğ°ĞºÑ€Ñ‹Ğ²Ğ°Ñ‚ÑŒ Ğ¾ĞºĞ½Ğ¾ Ğ¿Ñ€Ğ¸ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ğ¸ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ°
set-option -g remain-on-exit on

# Ñ†Ğ²ĞµÑ‚ bg Ğ¸ fg Ğ¿Ğ°Ğ½ĞµĞ»Ğ¸
set-option -g window-style "fg=#eed9f2,bg=default"


### ğŸ¤– >>= ğŸ¤– >>= ğŸ¤– >>= ğŸ¤–  session options  ğŸ¤– =<< ğŸ¤– =<< ğŸ¤– =<< ğŸ¤– ###


# ÑĞ¸Ğ³Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¾Ğ± Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸ĞµĞ¼
set-option -g visual-activity off
set-option -g visual-silence off
set-option -g silence-action other
# ĞºĞ°Ğº Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°Ñ‚ÑŒ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ Ğ² Ğ¾ĞºĞ½Ğ°Ñ…
set-option -g activity-action other
set-option -g visual-bell on


### ğŸ¤– >>= ğŸ¤– >>= ğŸ¤– >>= ğŸ¤–  server options  ğŸ¤– =<< ğŸ¤– =<< ğŸ¤– =<< ğŸ¤– ###


set-option -g set-clipboard off

set-option -g display-panes-time 1000
set-option -g display-time 2000

# Ğ¸Ğ½Ñ‚ĞµÑ€Ğ²Ğ°Ğ» Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ñ ÑÑ‚Ğ°Ñ‚ÑƒÑĞ½Ğ¾Ğ¹ Ğ¿Ğ°Ğ½ĞµĞ»Ğ¸
set-option -g status-interval 5

#TODO: ÑĞ´ĞµĞ»Ğ°Ñ‚ÑŒ ÑÑ‚Ğ°Ñ‚ÑƒÑ yadm
# #(yadm status --porcelain | awk '{ print $1 }')
# set -g status-right '#(cd #{pane_current_path}; git rev-parse --abbrev-ref HEAD)'
# set-option -g status-right "(yadm status)"


set-option -g update-environment \
  "DISPLAY\
  SSH_AGENT_ID\
  SSH_ASKPASS\
  SSH_AUTH_SOCK\
  SSH_AGENT_PID\
  SSH_CONNECTION\
  SSH_TTY\
  WINDOWID\
  XAUTHORITY"

set-option -g update-environment -r

# Ğ½ĞµÑ‚ Ñ„Ğ°Ğ¹Ğ»Ğ°
bind-key '$' run "~/.tmux/renew_env.sh"

unbind-key C-f
unbind-key C-n
unbind-key C-p
#TODO: Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ñ†Ğ²ĞµÑ‚Ğ°
# [Ctrl f :: copy-mode] Ğ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ğ¿Ğ¾Ğ¸ÑĞº Ñ ĞºĞ¾Ğ½Ñ†Ğ° Ğ±ÑƒÑ„ĞµÑ€Ğ°
bind-key -T copy-mode C-f command-prompt -i -I "#{pane_search_string}" -p "(search down)" "send -X search-forward-incremental \"%%%\""
# [Ctrl n :: copy-mode] Ğ¸ÑĞºĞ°Ñ‚ÑŒ Ñ ĞºĞ¾Ğ½Ñ†Ğ° Ğ±ÑƒÑ„ĞµÑ€Ğ°
bind-key -T copy-mode C-n send-keys -X search-again
# [Ctrl p :: copy-mode] Ğ¸ÑĞºĞ°Ñ‚ÑŒ Ñ Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ° Ğ±ÑƒÑ„ĞµÑ€Ğ°
bind-key -T copy-mode C-p send-keys -X search-reverse



# bind M-t split-window -h -c "#{pane_current_path}" ; resize-pane -Z ; run 'emacs -nw ~/.tmux.conf.local'
# Edit configuration and reload
# bind M-t new-window -n 'tmux.conf' "sh -c '\${EDITOR:-nano} ~/.tmux.conf && tmux source ~/.tmux.conf && tmux display \"Config reloaded\"'"

unbind-key M-/
# bind -n M-/ run-shell /root/.tmux/plugins/tmux-copycat/scripts/copycat_search.sh

bind-key M-r new-window -n 'tmux.conf' "sh -c '\${EDITOR:-nano} ~/.tmux.conf && tmux source ~/.tmux.conf && tmux display \"Config reloaded\"'"

unbind-key y
# TODO: Ñ€Ğ°Ğ·Ğ±Ğ¸Ñ‚ÑŒ Ğ½Ğ° 1. ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ½Ğ¾Ğ²Ğ¾Ğ¹ Ğ¿Ğ°Ğ½ĞµĞ»Ğ¸ Ñ Ñ†Ğ²ĞµÑ‚Ğ¾Ğ¼ 2. Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ Ğ² Ñ„Ğ¾Ğ½Ğµ
# 3. Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ½Ğ° Ğ¿Ñ€ĞµĞ´Ñ‹Ğ´ÑƒÑ‰ÑƒÑ Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ 4. Ğ² Ñ„Ğ¾Ğ½Ğµ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ Ğ¸ Ğ²Ñ‹Ğ²ĞµÑÑ‚Ğ¸ ĞµÑĞ»Ğ¸ Ğ¾ÑˆĞ¸Ğ±ĞºĞ°
# 5. Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚ÑŒ, ĞµÑĞ»Ğ¸ ÑÑ‚Ğ°Ñ‚ÑƒÑ Ğ²Ñ‹Ñ…Ğ¾Ğ´Ğ° 0
bind-key y split-window -v -p 20 "yadm pull && tmux kill-pane " \;\
  set-option -pt:. window-style bg=magenta \;\
  source ~/.tmux.conf \; select-pane -l
bind-key Y split-window -v -p 15 "yadm nc && yadm push"
# #{pane_dead_status} kill-pane
# tmux set-option -pt:. window-style bg=magenta
# resize-pane -t 1 -U 20
# resize-pane -t 1 -y 5

#              remain-on-exit [on | off]
#  split-window [-dhvP] [-c start-directory] [-l size | -p percentage] [-t
#          target-pane] [shell-command] [-F format]
# $TMUX_PANE

########## NOTE: Send keys
#
# https://blog.damonkelley.me/2016/09/07/tmux-send-keys/#list-of-keys
#
# When specifying keys, most represent themselves (for example â€˜Aâ€™ to â€˜Zâ€™). Ctrl keys may be prefixed with â€˜C-â€™ or â€˜^â€™, and Alt (meta) with â€˜M-â€™. In addition, the following special key names are accepted: Up, Down, Left, Right, BSpace, BTab, DC (Delete), End, Enter, Escape, F1 to F20, Home, IC (Insert), NPage/PageDown/PgDn, PPage/PageUp/PgUp, Space, and Tab.
#
# Although they are not listed in the man page, there are also special names for keypad-specific keys: KP0 through KP9, KP/, KP*, KP-, KP+, KP., and KPEnter.
#
# Several of the more cryptic key names (BTab, IC, DC, NPage, PPage) probably come from the terminfo library.




# https://unix.stackexchange.com/questions/149606/how-do-i-create-a-simple-tmux-conf-that-splits-a-window
# mux $(basename $(pwd)) \
#   "vim $(find src test resources test-resources -type f 2>/dev/null \
#     | tr "\n" " ")" \
#   "lein repl"

# https://github.com/samoshkin/tmux-config/blob/master/tmux/renew_env.sh
# set -eu
# pane_fmt="#{pane_id} #{pane_in_mode} #{pane_input_off} #{pane_dead} #{pane_current_command}"
# tmux list-panes -s -F "$pane_fmt" | awk '
#   $2 == 0 && $3 == 0 && $4 == 0 && $5 ~ /(bash|zsh|ksh|fish)/ { print $1 }
# ' | while read -r pane_id; do
#   # renew environment variables according to update-environment tmux option
#   # also clear screen
#   tmux send-keys -t "$pane_id" 'Enter' 'eval "$(tmux show-env -s)"' 'Enter' 'C-l'
# done;



# # send tmux buffer to pastebin
# #bind-key P run-shell "tmux save-buffer - | wgetpaste | awk '/:/ {print \$NF}' | xargs -I@ xdg-open \"@\" >/dev/null"
# bind-key P run-shell "tmux save-buffer - | sheetpaste.sh | xargs -I@ xdg-open \"@\" >/dev/null"
# bind-key Ğ— run-shell "tmux save-buffer - | sheetpaste.sh | xargs -I@ xdg-open \"@\" >/dev/null"



# ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹
## https://github.com/seamus-45/dotfiles/blob/master/.tmux.conf

# Smart pane switching with awareness of Vim splits.
# See: https://github.com/christoomey/vim-tmux-navigator
# is_vim="ps -o state= -o comm= -t '#{pane_tty}' \
#     | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?g?(view|n?vim?x?)(diff)?$'"
# bind-key -n M-h if-shell "$is_vim" "send-keys M-h"  "select-pane -L"

# bind-key -n S-Up command-prompt -I '#W' "rename-window '%%'"

# tmux prefix key
# set-option -g prefix M-`
# set-option -g prefix2 M-Ñ‘
# bind-key M-` send-prefix
# bind-key M-Ñ‘ send-prefix -2

# # Smart pane switching with awareness of vim splits
# # See: https://github.com/christoomey/vim-tmux-navigator
# is_vim='echo "#{pane_current_command}" | grep -iqE "(^|\/)g?(view|n?vim?)(diff)?$"'
# bind -n C-h if-shell "$is_vim" "send-keys C-h" "select-pane -L"
# bind -n C-j if-shell "$is_vim" "send-keys C-j" "select-pane -D"
# bind -n C-k if-shell "$is_vim" "send-keys C-k" "select-pane -U"
# bind -n C-l if-shell "$is_vim" "send-keys C-l" "select-pane -R"
# bind -n C-\ if-shell "$is_vim" "send-keys C-\\" "select-pane -l"

# Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€ Ğ±Ğ¸Ğ½Ğ´Ğ° Ğ½ĞµÑĞºĞ¾Ğ»ÑŒĞºĞ¸Ñ… Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğ¹ Ğ½Ğ° ĞºĞ»Ğ°Ğ²Ğ¸ÑˆÑƒ
bind -T root F12  \
  set status-right "#{sysstat_cpu} | #{sysstat_mem} | #{sysstat_swap} | #{sysstat_loadavg} | #[fg=cyan]#(echo $USER)#[default]@#H" \;\
  if -F '#{pane_in_mode}' 'send-keys -X' \;\
  refresh-client -S \;\

# bind -T copy-mode-vi Escape if-shell -F '#{selection_present}' \
#                                         'send-keys -X clear-selection' \
#                                         'send-keys -X cancel'

# wg_is_keys_off="#[fg=$color_light,bg=$color_window_off_indicator]#([ $(tmux show-option -qv key-table) = 'off' ] && echo ' OFF ')#[default]"
# set -g status-style right "$wg_is_keys_off#[fg=black,bg=cyan] #(curl https://am.i.mullvad.net/country) " # (#(curl https://am.i.mullvad.net/city))


### ğŸ¤– >>= ğŸ¤– >>= ğŸ¤–  configs and examples  ğŸ¤– =<< ğŸ¤– =<< ğŸ¤– ###

# ĞšĞ½Ğ¸Ğ¶ĞºĞ°
# https://leanpub.com/the-tao-of-tmux/read#scripting-tmux

# Ğ˜Ğ½Ñ‚ĞµÑ€ĞµÑĞ½Ñ‹Ğ¹ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³,Ğ¿Ñ€Ğ¾ Ğ¼Ñ‹ÑˆÑŒ
# https://github.com/kaushalmodi/dotfiles/blob/master/tmux/dot-tmux.conf

# ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ Ğ¿Ğ¾Ğ³Ğ¾Ğ´Ñ‹ Ğ² ÑÑ‚Ñ€Ğ¾ĞºĞµ ÑÑ‚Ğ°Ñ‚ÑƒÑĞ°
  # https://github.com/chubin/wttr.in
  # WEATHER='#(curl -s wttr.in/London:Stockholm:Moscow\?format\="%%l:+%%c%%20%%t%%60%%w&period=60")'
  # set -g status-right "$WEATHER ..."

# ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ ÑƒÑĞ»Ğ¾Ğ²Ğ¸Ğ¹
  # %if #{==:#{host},nb5} set-option -pt:. window-style bg=magenta %endif

  #  bind x if-shell "true" {
  #      if-shell "true" {
  #           display "true!"
  #      }
  #  }

  #  %if "#{==:#{host},myhost}"
  #  set -g status-style bg=red
  #  %elif "#{==:#{host},myotherhost}"
  #  set -g status-style bg=green
  #  %else
  #  set -g status-style bg=blue
  #  %endif

# ĞŸĞ¾ÑĞ»Ğ°Ñ‚ÑŒ Ğ¾Ğ´Ğ¸Ğ½Ğ°ĞºĞ¾Ğ²ÑƒÑ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñƒ Ğ²Ğ¾ Ğ²ÑĞµ Ğ¿Ğ°Ğ½ĞµĞ»Ğ¸ Ğ²ÑĞµÑ… Ğ¾ĞºĞ¾Ğ½
  # https://scripter.co/command-to-every-pane-window-session-in-tmux/
  # bind E command-prompt -p "Command:" \
  #        "run \"tmux list-panes -a -F '##{session_name}:##{window_index}.##{pane_index}' \
  #               | xargs -I PANE tmux send-keys -t PANE '%1' Enter\""

# Ğ£Ğ¼Ğ½Ğ¾Ğµ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸ĞµĞ¼ Ğ¿Ğ°Ğ½ĞµĞ»ĞµĞ¹,Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒÑ Ğ´Ñ€ÑƒĞ³Ğ¸Ğµ ÑĞ¾Ñ‡ĞµÑ‚Ğ°Ğ½Ğ¸Ñ ĞºĞ»Ğ°Ğ²Ğ¸Ñˆ, ĞºĞ¾Ğ³Ğ´Ğ° Ğ·Ğ°Ğ¿ÑƒÑ‰ĞµĞ½Ğ° Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»Ñ‘Ğ½Ğ½Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ°
# See: https://github.com/christoomey/vim-tmux-navigator
  # is_vim='echo "#{pane_current_command}" | grep -iqE "(^|\/)g?(view|n?vim?)(diff)?$"'
  # bind -n C-h if-shell "$is_vim" "send-keys C-h" "select-pane -L"
  # bind -n C-j if-shell "$is_vim" "send-keys C-j" "select-pane -D"
  # bind -n C-k if-shell "$is_vim" "send-keys C-k" "select-pane -U"
  # bind -n C-l if-shell "$is_vim" "send-keys C-l" "select-pane -R"
  # bind -n C-\ if-shell "$is_vim" "send-keys C-\\" "select-pane -l"

# TODO: ÑĞ´ĞµĞ»Ğ°Ñ‚ÑŒ Ğ²Ñ‹Ğ±Ğ¾Ñ€ Ğ¾ĞºĞ½Ğ° Ñ FZF
# bind   W split-window "tmux lsw | peco --initial-index `tmux lsw | awk '/active.$/ {print NR-1}'` | cut -d':' -f 1 | xargs tmux select-window -t"
# switch to another session by name
# bind   S split-window "tmux ls | peco --initial-index `tmux ls | awk '/attached.$/ {print NR-1}'` | cut -d':' -f 1 | xargs tmux switch-client -t"
# # switch to ANY window in ANY session by name
# bind   s split-window "tmux ls | cut -d: -f1 | xargs -I SESSION tmux lsw -F 'SESSION:#{window_name}' -t SESSION | peco --initial-index `tmux ls | cut -d: -f1 | xargs -I SESSION tmux lsw -F '___#{session_attached}#{window_active}___' -t SESSION | awk '/___11___/ {print NR-1}'` | xargs tmux switch-client -t"

bind-key C-Space set-option -g pane-border-status off

# [ Alt - w ]ÑĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ğ¼Ğ¾Ğµ Ğ±ÑƒÑ„ĞµÑ€Ğ° tmux Ğ² Ğ±ÑƒÑ„ĞµÑ€ X
# bind -n M-w run-shel  l -b "tmux show-buffer | xclip -i -sel pri && tmux show-buffer | xclip -i -sel cli"

# Ğ·Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ñ‚ÑŒ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ğ¼Ğ¾Ğµ Ğ±ÑƒÑ„ĞµÑ€Ğ° X Ğ² Ğ±ÑƒÑ„ĞµÑ€ tmux Ğ¸ Ğ²ÑÑ‚Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ² Ñ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ğ»
bind-key C-y run-shel -b "xclip -o -sel pri | tmux load-buffer - && tmux paste-buffer -s ' '"

# bind-key = set-option synchronize-panes\; display-message "synchronize-panes is now #{?pane_synchronized,on,off}"

# [ Prefix = ] Ğ²Ñ‹Ğ´ĞµĞ»Ğ¸Ñ‚ÑŒ Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ ĞºÑ€Ğ°ÑĞ½Ñ‹Ğ¼ Ğ¿Ñ€Ğ¸ Ğ²ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¸ ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸
bind-key = if -F '#{pane_synchronized}' \
  'setw synchronize-panes off; \
    setw pane-active-border-style "bg=default,fg=#64b5f6"; \
    setw pane-border-format " #P :: #T "' \
  'setw synchronize-panes on; \
    setw pane-active-border-style "fg=#f11e1e"; \
    setw pane-border-format " #P - Pane Synchronization ON "'

# https://github.com/arl/tmux-gitbar
# Ğ½Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚
# TMUX_GITBAR_DIR="~/.tmux/.tmux-gitbar"
# TMGB_STATUS_STRING="#{git_branch} - #{git_upstream} - #{git_remote} #{git_flags}"
# TMGB_STATUS_LOCATION='right'
# TMGB_STYLE='bg=black,fg=white,bright'
# source-file "~/.tmux/.tmux-gitbar/tmux-gitbar.tmux"


	# assert "$(cat $tmp/file1)" "waiting"
	# tmux send-keys -t $tsession:0 "xyz" C-m ; zz
	# assert "$(cat $tmp/file1)" "waiting"
	# tmux send-keys -t $tsession:0 " " ; zz
	# assert "$(cat $tmp/file1)" "finished"
	# tmux send-keys -t $tsession:0 "q" ; zz
	# tmux kill-session -t $tsession

# bind -T root F12  \
#   if -F '#{pane_in_mode}' 'send-keys -X' \;\
#   refresh-client -S \;\

  # bind M-t split-window -h -c "#{pane_current_path}" ; resize-pane -Z ; run 'emacs -nw ~/.tmux.conf.local'

  # bind-key y split-window -v -p 20 "yadm pull" \; source ~/.tmux.conf \; select-pane -l

  # bind   W split-window "tmux lsw | peco --initial-index `tmux lsw | awk '/active.$/ {print NR-1}'` | cut -d':' -f 1 | xargs tmux select-window -t"

# if-shell 'test -n "$SSH_CLIENT"' \   'source-file ~/.tmux/tmux.remote.conf'

# Ğ½Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚
# %if "#{==:#{host},nb}" rename-session -t 0 WSL %endif
# %if "#{==:#{host},nb5}" rename-session -t 0 WSL %endif
# %if "#{==:#{host},dk}" run-shell 'tmux rename-session dk' %endif

# tmux lsw -F "#{window_active} #{window_layout}" | grep "^1" | cut -d " " -\f2
# tmux select-layout "f336,144x39,0,0{72x39,0,0,0,71x39,73,0[71x19,73,0,1,71x19,73,20,2]}"
# tmux list-panes -F "#{pane_id} #{pane_current_command} #{pane_current_path} #{cursor_x},#{cursor_y}"

bind-key C command-prompt -p "Name of new window: " "new-window -n '%%'"

bind-key M-r respawn-pane -k
# tmux set -g remain-on-exit on

unbind-key -T copy-mode  M-1
unbind-key -T copy-mode  M-2
unbind-key -T copy-mode  M-3
unbind-key -T copy-mode  M-4
unbind-key -T copy-mode  M-5
unbind-key -T copy-mode  M-6
unbind-key -T copy-mode  M-7
unbind-key -T copy-mode  M-8
unbind-key -T copy-mode  M-9


### ğŸ¤– >>= ğŸ¤– >>= ğŸ¤–  custom functions  ğŸ¤– =<< ğŸ¤– =<< ğŸ¤– ###

# [ Prefix Alt - s ] Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ½Ğ¾Ğ²Ğ¾Ğµ Ğ¾ĞºĞ½Ğ¾ Ñ ssh
# TODO: ÑĞ´ĞµĞ»Ğ°Ñ‚ÑŒ Ñ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ¾Ğ¼ FXF
bind-key M-s command-prompt -p "ğŸ‘¤ SSH host ==>" -I "px.rwxrwxrwx.dev" "new-window -n %1 'ssh %1'"

# [ Prefix Alt - w ] Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ½Ğ¾Ğ²Ğ¾Ğµ Ğ¾ĞºĞ½Ğ¾ Ñ watch
bind-key M-w command-prompt -p "ğŸ•” <|watch|> (sec) ==>,ğŸ•” <|watch|> (command) ==>" -I "1," "split-window -v -c '#{pane_current_path}' -p 30 'watch -c -n %1 -x %2'"

# [ Prefix Alt - t ] Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ½Ğ¾Ğ²Ğ¾Ğµ Ğ¾ĞºĞ½Ğ¾ Ñ man
bind-key M-t set-option -g remain-on-exit off \; command-prompt -p "ğŸ¸ man ==>" "new-window -n 'man %1' 'tldr %1' \; split-window -h -p 70 'PAGER=most man %1'" \; set-option remain-on-exit on

# [ Prefix Alt - y ] Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ½Ğ¾Ğ²Ğ¾Ğµ Ğ¾ĞºĞ½Ğ¾ Ñ youtube-dl
bind-key M-y command-prompt -p "ğŸ”— <|youtube-dl|> URL ==>,ğŸ”— <|youtube-dl|> Select category (tech/mtb/diy) ==>" -I ",in" "new-window -n 'youtube-dl' 'youtube-dl --all-subs --output /mnt/ds/Video/youtube/%2/%\\(upload_date\\)s-%\\(title\\)s.%\\(ext\\)s %1'"

bind -T root F12  \
  set status-right "#{sysstat_cpu} | #{sysstat_mem} | #{sysstat_swap} | #{sysstat_loadavg} | #[fg=cyan]#(echo $USER)#[default]@#H" \;\
  if -F '#{pane_in_mode}' 'send-keys -X' \;\
  refresh-client -S \;\

# TODO: ÑĞ´ĞµĞ»Ğ°Ñ‚ÑŒ entr, Ñ FZF
# http://eradman.com/entrproject/
bind -n F10 \
	split-window -h -c "#{pane_current_path}" \;\
  send-keys "ls $tmp/file2 | ./entr -p cp $tmp/file2 $tmp/file1" C-m ;

# ls -d /tmp/file1 /tmp/file2 | entr -c colordiff /tmp/file1 /tmp/file2
# find . -print | grep -i '.*[.]go' | entr -c go test ./...
# if command -v entr > /dev/null; then find . -print | grep -i '.*[.]go' | \
  # entr -c go test ./...; else go test ./...; echo "\nInstall entr(1) to \"
  # echo "run tasks when files change. \nSee http://entrproject.org/"; fi

# TODO: ÑĞ´ĞµĞ»Ğ°Ñ‚ÑŒ Ğ²Ñ‚Ğ¾Ñ€ÑƒÑ Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ Ñ Ğ¸Ğ½Ñ„Ğ¾, Ğ½Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾
# https://www.freecodecamp.org/news/tmux-in-practice-local-and-nested-remote-tmux-sessions-4f7ba5db8795/
bind -n F9 if -F "#{==:#{status},on}" \
  "set-option -g status 2; \
    set-option -g status-format[1] '#[fg=#80cbc4,bg=#6a1b9a,bold] ğŸ‘½ #{free_mem} #{download_speed} #{upload_speed} #{net_speed} #{sysstat_cpu} #{sysstat_mem} #{sysstat_swap} #{sysstat_loadavg}'" \
  "set-option -g status on"
	# status-format[1] "#[align=left range=left #{status-left-style}]#{T;=/#{status-left-length}:status-left}#[norange default]#[list=on align=#{status-justify}]#[list=left-marker]<#[list=right-marker]>#[list=on]#{W:#[range=window|#{window_index} #{window-status-style}#{?#{&&:#{window_last_flag},#{!=:#{window-status-last-style},default}}, #{window-status-last-style},}#{?#{&&:#{window_bell_flag},#{!=:#{window-status-bell-style},default}}, #{window-status-bell-style},#{?#{&&:#{||:#{window_activity_flag},#{window_silence_flag}},#{!=:#{window-status-activity-style},default}}, #{window-status-activity-style},}}]#{T:window-status-format}#[norange default]#{?window_end_flag,,#{window-status-separator}},#[range=window|#{window_index} list=focus #{?#{!=:#{window-status-current-style},default},#{window-status-current-style},#{window-status-style}}#{?#{&&:#{window_last_flag},#{!=:#{window-status-last-style},default}}, #{window-status-last-style},}#{?#{&&:#{window_bell_flag},#{!=:#{window-status-bell-style},default}}, #{window-status-bell-style},#{?#{&&:#{||:#{window_activity_flag},#{window_silence_flag}},#{!=:#{window-status-activity-style},default}}, #{window-status-activity-style},}}]#{T:window-status-current-format}#[norange list=on default]#{?window_end_flag,,#{window-status-separator}}}#[nolist align=right range=right #{status-right-style}]#{T;=/#{status-right-length}:status-right}#[norange default]"


### ğŸ¤– >>= ğŸ¤– >>= ğŸ¤– >>= ğŸ¤–  plugins  ğŸ¤– =<< ğŸ¤– =<< ğŸ¤– =<< ğŸ¤– ###

# https://github.com/tmux-plugins/tpm
# git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm

set-option -g @plugin 'tmux-plugins/tpm'

# https://github.com/tmux-plugins/tmux-resurrect
set-option -g @plugin 'tmux-plugins/tmux-resurrect'
# Ğ¿Ñ‹Ñ‚Ğ°Ñ‚ÑŒÑÑ Ğ²Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ğ¼Ğ¾Ğµ Ğ¿Ğ°Ğ½ĞµĞ»ĞµĞ¹
# set-option -g @resurrect-capture-pane-contents 'on'
# multitail -R 2 -l "netstat -t" -l "tail -f /var/lib/docker/volumes/traefik_logs/_data/traefik.log"
# ~/.tmux/resurrect/last
# set-option -g @resurrect-processes '~multitail "~log"'
# set-option -g @resurrect-processes 'mosh-client'

# https://github.com/tmux-plugins/tmux-continuum
set-option -g @plugin 'tmux-plugins/tmux-continuum'
# Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ²Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½ĞµĞµ ÑĞ¾Ñ…Ñ€Ğ°Ğ½Ñ‘Ğ½Ğ½Ğ¾Ğµ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¸ ÑÑ‚Ğ°Ñ€Ñ‚Ğµ tmux
# set-option -g @continuum-restore 'on'
# Ğ¸Ğ½Ñ‚ĞµÑ€Ğ²Ğ°Ğ» ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ñ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ (default 15)
set-option -g @continuum-save-interval '15'

set-option -g @plugin 'tmux-plugins/tmux-logging'

# set-option -g @plugin 'tmux-plugins/tmux-copycat'

# https://github.com/tmux-plugins/tmux-prefix-highlight
set-option -g @plugin 'tmux-plugins/tmux-prefix-highlight'
# set-option -g @prefix_highlight_empty_prompt 'ğŸ’œ'
set-option -g @prefix_highlight_prefix_prompt 'ğŸ’™'
set-option -g @prefix_highlight_copy_prompt 'ğŸ’œ'
set-option -g @prefix_highlight_empty_attr 'fg=default,bg=#6c6cd2'
set-option -g @prefix_highlight_fg "#6a1b9a"
set-option -g @prefix_highlight_bg "#6c6cd2"
set-option -g @prefix_highlight_show_copy_mode 'on'
set-option -g @prefix_highlight_copy_mode_attr "fg=#6a1b9a,bg=#6c6cd2"

set-option -g @plugin 'tmux-plugins/tmux-online-status'

set-option -g @plugin 'tmux-plugins/tmux-sidebar'
set-option -g @sidebar-tree 't'
set-option -g @sidebar-tree-focus 'T'
set-option -g @sidebar-tree-command 'tree -C'

# https://github.com/kristijanhusak/tmux-simple-git-status
# Ğ½Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚
set-option -g @plugin 'kristijanhusak/tmux-simple-git-status'

# run-shell ~/tmux-sidebar-plus/sidebar-plus.tmux
# set-option -g @sidebar-plus-sidebar-key 'M-r'

# https://github.com/knakayama/tmux-newline-detector
set-option -g @plugin knakayama/tmux-newline-detector

# https://github.com/laktak/extrakto
set-option -g @plugin 'laktak/extrakto'

# https://github.com/jimeh/tmux-themepack
# set-option -g @plugin 'jimeh/tmux-themepack'
# set-option -g @themepack 'powerline/double/magenta'
# set-option -g @themepack 'powerline/double/blue'

# https://github.com/odedlaz/tmux-status-variables
set-option -g @plugin "odedlaz/tmux-status-variables"
# Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ñ Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒÑĞºĞ¸Ğ¼Ğ¸ ÑĞºÑ€Ğ¸Ğ¿Ñ‚Ğ°Ğ¼Ğ¸
set-option -g @user_scripts_dir "~/.scripts"
# Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ° ipinfo
set-option -g @ipinfo_format "#hostname #city #region #location"

# https://github.com/beeryardtech/tmux-net-speed
set-option -g @plugin "tmux-plugins/tmux-net-speed"
set-option -g @net_speed_interfaces "eth0"
set-option -g @download_speed_format "%10s"
set-option -g @upload_speed_format "%10s"
set-option -g @net_speed_format "D:%10s U:%10s"

# https://github.com/eugene-eeo/tmux-badges
set-option -g @plugin "eugene-eeo/tmux-badges"
set-option -g @badge_docker "ğŸ³:"
set-option -g @badge_docker_fg "#6a1b9a"
set-option -g @badge_docker_bg "#6c6cd2"
set-option -g @badge_docker_secondary_fg "#6a1b9a"
set-option -g @badge_docker_secondary_bg "#6c6cd2"
set-option -g @badge_docker_fmt "#(docker system info --format '{{json .Name}}' | xargs)"
set-option -g @badge_yadm "ğŸ€:"
set-option -g @badge_yadm_fg "#6a1b9a"
set-option -g @badge_yadm_bg "#6c6cd2"
set-option -g @badge_yadm_secondary_fg "#6a1b9a"
set-option -g @badge_yadm_secondary_bg "#6c6cd2"
set-option -g @badge_yadm_fmt "#(yadm status --porcelain | awk '{ print $1 }')"

# https://github.com/samoshkin/tmux-plugin-sysstat
set-option -g @plugin 'samoshkin/tmux-plugin-sysstat'
set-option -g @sysstat_cpu_view_tmpl '#[fg=#{cpu.color3}]CPU:#[default]#[fg=#{cpu.color},bg=#{cpu.color2}]#{cpu.pused}#[default]'
set-option -g @sysstat_mem_view_tmpl 'MEM:#[fg=#{mem.color}]#{mem.used}#[default]/#{mem.total}'
set-option -g @sysstat_cpu_color_low "$color_level_ok default default"
set-option -g @sysstat_cpu_color_medium "$color_level_warn default default"
set-option -g @sysstat_cpu_color_stress "white,bold $color_level_stress $color_level_stress"
set-option -g @sysstat_mem_color_low "$color_level_ok"
set-option -g @sysstat_mem_color_medium "$color_level_warn"
set-option -g @sysstat_mem_color_stress "$color_level_stress"

# TODO: Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ñ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡Ñ‘Ğ½Ğ½Ñ‹Ğ¼ docker host
# Get https://192.168.88.130:2376/v1.40/containers/json: x509: certificate is valid for 127.0.0.1, ::1, not 192.168.88.130
# "tlscacert": "/root/dev/.docker/ut/ca.pem"
set-option -g @plugin stonevil/tmux-docker-status
set -g @docker_icon "DOCKER CONTAINERS"

# https://github.com/tmux-plugins/tmux-open
set -g @plugin 'tmux-plugins/tmux-open'
# Ğ¿ĞµÑ€ĞµĞ½Ğ°Ğ·Ğ½Ğ°Ñ‡Ğ¸Ñ‚ÑŒ ĞºĞ»Ğ°Ğ²Ğ¸ÑˆÑƒ Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚Ğ¸Ñ ÑÑÑ‹Ğ»ĞºĞ¸ system default file viewer (default 'o')
set-option -g @open 'o'
# Ğ¿ĞµÑ€ĞµĞ½Ğ°Ğ·Ğ½Ğ°Ñ‡Ğ¸Ñ‚ÑŒ ĞºĞ»Ğ°Ğ²Ğ¸ÑˆÑƒ Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚Ğ¸Ñ ÑÑÑ‹Ğ»ĞºĞ¸ $EDITOR (default 'C-o')
set-option -g @open 'C-o'
# Ğ¿Ğ¾Ğ¼ĞµĞ½ÑÑ‚ÑŒ Ğ¿Ğ¾Ğ¸ÑĞºĞ¾Ğ²Ñ‹Ğ¹ Ğ´Ğ²Ğ¸Ğ¶Ğ¾Ğº (default 'https://www.google.com/search?q=')
set-option -g @open-S 'https://www.google.com/search?q='
# Ğ½Ğ°Ğ·Ğ½Ğ°Ñ‡Ğ¸Ñ‚ÑŒ ĞºĞ»Ğ°Ğ²Ğ¸ÑˆÑƒ Ğ¿Ğ¾Ğ¸ÑĞºĞ° Ñ‡ĞµÑ€ĞµĞ· Ğ´Ñ€ÑƒĞ³Ğ¾Ğ¹ Ğ¿Ğ¾Ğ¸ÑĞºĞ¾Ğ²Ñ‹Ğ¹ Ğ´Ğ²Ğ¸Ğ¶Ğ¾Ğº [ Shift - s :: copy-mode ]
set-option -g @open-B 'https://www.duckduckgo.com/'


# # online and offline icon for tmux-online-status
# set-option -g @online_icon "#[fg=$color_level_ok]â—#[default]"
# set-option -g @offline_icon "#[fg=$color_level_stress]â—#[default]"

# https://github.com/charlietag/tmux-split-statusbar
# set -g @plugin 'charlietag/tmux-split-statusbar'
# set -g @split-statusbar-bindkey '-n F11'
# set -g @split-status-hide-bindkey '-n F12'

if "[ ! -d ~/.tmux/plugins/tpm ]" \
  "split-window -h -p 40 'git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm && ~/.tmux/plugins/tpm/bin/install_plugins'"
  # \; source ~/.tmux.conf \; select-pane -l
  # "run 'git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm && ~/.tmux/plugins/tpm/bin/install_plugins'"

# Initialize TMUX plugin manager ğŸ¤
run-shell -b '~/.tmux/plugins/tpm/tpm'